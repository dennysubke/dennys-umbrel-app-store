version: "3.7"

services:
  app_proxy:
    environment:
      APP_HOST: denny-gitea-mirror_web_1
      APP_PORT: 4321

  web:
    image: ghcr.io/raylabshq/gitea-mirror:3.3.0
    restart: on-failure
    user: "1000:1000"
    environment:
      PORT: "4321"
      PUID: "1000"
      PGID: "1000"
      BETTER_AUTH_SECRET: "1f3a8b27c9d84e77a2fcb845c1de5a90"
      ENCRYPTION_SECRET: "c4b18f278e324a2c9f7e1b943b6df120"
      SCHEDULE_ENABLED: "true"
      SCHEDULE_INTERVAL: "3600"
      GITEA_MIRROR_INTERVAL: "8h"
      AUTO_IMPORT_REPOS: "true"
      CLEANUP_DELETE_IF_NOT_IN_GITHUB: "true"
      CLEANUP_ORPHANED_REPO_ACTION: "archive"
    volumes:
      - ${APP_DATA_DIR}/data:/app/data
